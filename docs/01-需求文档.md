# 终端安全监控系统 - 完整需求文档

## 版本信息

| 项目 | 内容 |
|------|------|
| 版本号 | v1.0.0 |
| 文档版本 | 3.0 |
| 创建日期 | 2026-02-11 |
| 状态 | 正式发布 |

---

## 目录

1. [项目概述](#1-项目概述)
2. [系统架构](#2-系统架构)
3. [Phase 1: 终端信息采集与监控](#3-phase-1-终端信息采集与监控)
4. [Phase 2: 行为基线与安全告警](#4-phase-2-行为基线与安全告警)
5. [非功能需求](#5-非功能需求)
6. [约束条件](#6-约束条件)
7. [验收标准](#7-验收标准)
8. [术语表](#8-术语表)

---

## 1. 项目概述

### 1.1 项目简介

终端安全监控系统是一个轻量级的终端安全监控解决方案，支持Linux/Windows双平台。该系统通过在目标终端部署Agent，实时采集系统信息（进程、端口、登录行为等），上报至后端服务器进行存储和分析，并通过Web界面进行集中展示和监控。

### 1.2 系统目标

- **实时监控**：实时采集和展示终端运行状态
- **安全防护**：通过行为基线检测异常行为
- **统一管理**：集中管理所有终端节点
- **告警响应**：及时发现和处理安全威胁

### 1.3 技术栈

| 层级 | 技术选型 |
|------|----------|
| Agent端 | Python 3.8+ / psutil / requests |
| 后端 | Java 17 / SpringBoot 3.2 / MySQL 8.0 |
| 前端 | Vue 3 / Element Plus / Vite |
| 数据库 | MySQL 8.0 (后端) / SQLite 3 (Agent本地缓存) |
| 部署 | Docker / Docker Compose |

---

## 2. 系统架构

### 2.1 整体架构

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              Web 前端 (Vue 3)                            │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │
│  │ Dashboard   │  │ Agent管理   │  │ 基线管理   │  │ 告警中心    │    │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │
└────────────────────────────────────────────┬────────────────────────────┘
                                             │ REST API / WebSocket
┌────────────────────────────────────────────┼────────────────────────────┐
│                         后端服务 (SpringBoot 3.2)                        │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      API Controller 层                            │   │
│  │    AgentController / BaselineController / AlertController         │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      Service 业务逻辑层                           │   │
│  │  AgentService / BaselineService / AlertService / 各类Service     │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      Repository 数据访问层                         │   │
│  └─────────────────────────────────────────────────────────────────┘   │
└────────────────────────────────────────────┬────────────────────────────┘
                                             │ JPA / MySQL
┌────────────────────────────────────────────┼────────────────────────────┐
│                         数据库层 (MySQL 8.0)                            │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │
│  │ Agent表    │  │ 监控数据表  │  │ 基线配置表  │  │ 告警表      │   │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │
└─────────────────────────────────────────────────────────────────────────┘
                              ▲
                              │ HTTPS REST API
┌─────────────────────────────────────────────────────────────────────────┐
│                          Agent (Python 3.8+)                             │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      数据采集器 (Collectors)                       │   │
│  │  ProcessCollector / PortCollector / SystemCollector             │   │
│  │  NetworkCollector / SoftwareCollector / USBCollector            │   │
│  │  LoginCollector                                               │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      本地存储 (SQLite)                           │   │
│  │  AgentDatabase / 数据队列 / 离线缓存                             │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      数据上报 (DataReporter)                      │   │
│  │  注册Agent / 发送心跳 / 上报数据 / 断网重连                       │   │
│  └─────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.2 数据流程

```
┌──────────┐     定时采集      ┌──────────┐     上报数据      ┌──────────┐
│  终端    │ ──────────────► │  Agent   │ ──────────────► │  后端    │
│  (Host)  │                 │ (Python) │                 │ (Java)   │
└──────────┘                 └──────────┘                 └────┬─────┘
                                                                │
                                                                ▼
                                                       ┌──────────────┐
                                                       │   MySQL      │
                                                       │   数据库     │
                                                       └──────┬───────┘
                                                              │
                                                              ▼
                                                       ┌──────────────┐
                                                       │   Web UI     │
                                                       │   展示分析   │
                                                       └──────────────┘
```

---

## 3. Phase 1: 终端信息采集与监控

### 3.1 Agent功能需求

#### 3.1.1 Agent注册

| 功能编号 | F-AGENT-001 |
|---------|-------------|
| 功能名称 | Agent自动注册 |
| 功能描述 | Agent启动时自动向服务器注册，获取唯一的Agent ID |
| 优先级 | P0 (必须) |
| 输入 | Agent名称、平台信息、主机名、IP地址 |
| 输出 | 注册结果、Agent ID |
| 处理逻辑 | 1. 采集本机信息<br>2. 构造注册请求<br>3. 发送到服务器<br>4. 保存Agent ID |

#### 3.1.2 心跳上报

| 功能编号 | F-AGENT-002 |
|---------|-------------|
| 功能名称 | 定期心跳上报 |
| 功能描述 | 按设定间隔向服务器发送心跳，维持在线状态 |
| 优先级 | P0 (必须) |
| 配置参数 | heartbeat_interval (默认30秒) |
| 处理逻辑 | 1. 构造心跳数据<br>2. 发送到服务器<br>3. 处理响应结果 |

#### 3.1.3 数据采集

| 功能编号 | F-AGENT-003 |
|---------|-------------|
| 功能名称 | 系统信息采集 |
| 功能描述 | 采集终端各类系统信息 |
| 优先级 | P0 (必须) |
| 采集项 | 详见3.1.4-3.1.10 |
| 配置参数 | collect_interval (默认60秒) |

#### 3.1.4 进程信息采集

| 采集项 | 字段名 | 数据类型 | 说明 |
|--------|--------|----------|------|
| 进程ID | pid | Integer | 进程唯一标识 |
| 进程名 | name | String | 进程名称 |
| CPU占用 | cpu_percent | Double | CPU使用率 (%) |
| 内存占用 | memory_percent | Double | 内存使用率 (%) |
| 进程状态 | status | String | running/sleeping/zombie等 |
| 启动时间 | create_time | String | 进程启动时间 |
| 用户名 | username | String | 进程所属用户 |

#### 3.1.5 端口信息采集

| 采集项 | 字段名 | 数据类型 | 说明 |
|--------|--------|----------|------|
| 端口号 | port | Integer | TCP/UDP端口 |
| 协议 | protocol | String | TCP/UDP |
| 状态 | status | String | LISTEN/CONNECTED等 |
| 进程ID | pid | Integer | 绑定进程的PID |
| 进程名 | process_name | String | 绑定进程的名称 |

#### 3.1.6 主机信息采集

| 采集项 | 字段名 | 数据类型 | 说明 |
|--------|--------|----------|------|
| CPU品牌 | cpu_brand | String | CPU型号名称 |
| CPU架构 | cpu_arch | String | x86/x64/arm等 |
| CPU核心数 | cpu_cores | Integer | 物理核心数 |
| CPU线程数 | cpu_threads | Integer | 逻辑线程数 |
| CPU频率 | cpu_frequency | Double | CPU频率 (GHz) |
| 内存总量 | memory_total | Long | 内存总量 (字节) |
| 内存可用 | memory_available | Long | 可用内存 (字节) |
| 内存使用率 | memory_percent | Double | 内存使用率 (%) |
| 存储设备 | storage_devices | JSON | 存储设备列表 |
| 存储总量 | storage_total | Long | 存储总量 (字节) |
| 主板型号 | motherboard_model | String | 主板型号 |
| BIOS版本 | bios_version | String | BIOS版本 |
| 操作系统 | os_name | String | 操作系统名称 |
| 系统版本 | os_version | String | 操作系统版本 |
| 内核版本 | kernel_version | String | Linux内核版本 |
| MAC地址 | mac_addresses | JSON | 网络接口MAC地址列表 |
| IP地址 | ip_addresses | JSON | 网络接口IP地址列表 |

#### 3.1.7 网络接口采集

| 采集项 | 字段名 | 数据类型 | 说明 |
|--------|--------|----------|------|
| 接口名称 | interface | String | 网卡名称 |
| IP地址 | ip_address | String | IPv4地址 |
| 子网掩码 | netmask | String | 子网掩码 |
| MAC地址 | mac | String | MAC地址 |
| 广播地址 | broadcast | String | 广播地址 |
| 状态 | up | Boolean | 接口是否启用 |

#### 3.1.8 已安装软件采集

| 采集项 | 字段名 | 数据类型 | 说明 |
|--------|--------|----------|------|
| 软件名称 | name | String | 软件名称 |
| 版本 | version | String | 软件版本 |
| 发行商 | publisher | String | 软件发行商 |
| 安装日期 | install_date | String | 安装日期 |
| 安装路径 | install_location | String | 安装目录 |

#### 3.1.9 USB设备采集

| 采集项 | 字段名 | 数据类型 | 说明 |
|--------|--------|----------|------|
| 设备名称 | device_name | String | USB设备名称 |
| 设备类型 | device_type | String | 磁盘/摄像头/键盘等 |
| 厂商ID | vendor_id | String | VID |
| 产品ID | product_id | String | PID |
| 序列号 | serial_number | String | 设备序列号 |
| 制造商 | manufacturer | String | 制造商名称 |
| 接入时间 | plugged_time | DateTime | 设备插入时间 |

#### 3.1.10 登录日志采集

| 采集项 | 字段名 | 数据类型 | 说明 |
|--------|--------|----------|------|
| 用户名 | username | String | 登录用户名 |
| 登录类型 | login_type | String | SSH/RDP/Console等 |
| 登录时间 | login_time | DateTime | 登录时间 |
| 登出时间 | logout_time | DateTime | 登出时间 |
| 登录IP | login_ip | String | 登录来源IP |
| 登录状态 | login_status | String | SUCCESS/FAILED |
| 会话ID | session_id | String | 登录会话标识 |
| 来源 | source | String | 日志来源 |

#### 3.1.11 本地缓存

| 功能编号 | F-AGENT-004 |
|---------|-------------|
| 功能名称 | SQLite本地存储 |
| 功能描述 | 在本地SQLite数据库中缓存采集数据 |
| 优先级 | P1 (重要) |
| 数据表 | agents / processes / ports / data_queue |
| 处理逻辑 | 1. 采集数据存入SQLite<br>2. 上报成功后标记已同步<br>3. 断网时持续采集存储 |

#### 3.1.12 离线队列

| 功能编号 | F-AGENT-005 |
|---------|-------------|
| 功能名称 | 数据上报队列 |
| 功能描述 | 网络中断时将数据加入队列，联网后自动重试 |
| 优先级 | P1 (重要) |
| 配置参数 | retry_times (重试次数默认3) / retry_interval (重试间隔默认5秒) |
| 处理逻辑 | 1. 上报失败的数据存入队列<br>2. 定时检查队列<br>3. 重新上报直到成功 |

### 3.2 后端功能需求

#### 3.2.1 Agent注册接口

| 接口编号 | API-001 |
|---------|---------|
| 接口地址 | POST /api/agents/register |
| 接口描述 | 注册或更新Agent信息 |
| 请求参数 | agentId, name, platform, hostname, ipAddress |
| 响应数据 | success, agentId, message |
| 优先级 | P0 |

#### 3.2.2 心跳接口

| 接口编号 | API-002 |
|---------|---------|
| 接口地址 | POST /api/agents/{agentId}/heartbeat |
| 接口描述 | 接收Agent心跳，更新在线状态 |
| 请求参数 | status |
| 响应数据 | success, message |
| 优先级 | P0 |

#### 3.2.3 数据上报接口

| 接口编号 | API-003 |
|---------|---------|
| 接口地址 | POST /api/agents/{agentId}/data |
| 接口描述 | 接收Agent上报的监控数据 |
| 请求参数 | data_type, data, timestamp |
| 数据类型 | processes / ports / host_info / network / installed_software / usb_devices / login_logs |
| 响应数据 | success, message |
| 优先级 | P0 |

#### 3.2.4 Agent管理接口

| 接口编号 | API-004 |
|---------|---------|
| 接口地址 | GET /api/agents |
| 接口描述 | 获取所有Agent列表 |
| 响应数据 | Agent列表 |
| 优先级 | P0 |

| 接口编号 | API-005 |
|---------|---------|
| 接口地址 | GET /api/agents/{agentId} |
| 接口描述 | 获取指定Agent详情 |
| 响应数据 | Agent完整信息 |
| 优先级 | P0 |

| 接口编号 | API-006 |
|---------|---------|
| 接口地址 | PUT /api/agents/{agentId} |
| 接口描述 | 更新Agent信息 |
| 请求参数 | name等 |
| 响应数据 | success, message |
| 优先级 | P1 |

| 接口编号 | API-007 |
|---------|---------|
| 接口地址 | DELETE /api/agents/{agentId} |
| 接口描述 | 删除Agent |
| 响应数据 | success, message |
| 优先级 | P1 |

#### 3.2.5 数据查询接口

| 接口编号 | API-008 |
|---------|---------|
| 接口地址 | GET /api/agents/{agentId}/processes |
| 接口描述 | 获取Agent进程列表 |
| 响应数据 | ProcessInfo列表 |
| 优先级 | P0 |

| 接口编号 | API-009 |
|---------|---------|
| 接口地址 | GET /api/agents/{agentId}/ports |
| 接口描述 | 获取Agent端口列表 |
| 响应数据 | PortInfo列表 |
| 优先级 | P0 |

| 接口编号 | API-010 |
|---------|---------|
| 接口地址 | GET /api/agents/{agentId}/host-info |
| 接口描述 | 获取Agent主机信息 |
| 响应数据 | HostInfo列表 |
| 优先级 | P0 |

| 接口编号 | API-011 |
|---------|---------|
| 接口地址 | GET /api/agents/{agentId}/installed-software |
| 接口描述 | 获取Agent已安装软件列表 |
| 响应数据 | InstalledSoftware列表 |
| 优先级 | P1 |

| 接口编号 | API-012 |
|---------|---------|
| 接口地址 | GET /api/agents/{agentId}/usb-devices |
| 接口描述 | 获取Agent USB设备列表 |
| 响应数据 | UsbDevice列表 |
| 优先级 | P1 |

| 接口编号 | API-013 |
|---------|---------|
| 接口地址 | GET /api/agents/{agentId}/login-logs |
| 接口描述 | 获取Agent登录日志列表 |
| 响应数据 | LoginLog列表 |
| 优先级 | P1 |

### 3.3 前端功能需求

#### 3.3.1 Dashboard页面

| 功能编号 | F-WEB-001 |
|---------|-----------|
| 功能名称 | 系统总览仪表盘 |
| 功能描述 | 展示系统整体状态和关键指标 |
| 展示内容 | Agent总数/在线数、告警统计、系统资源使用情况 |
| 优先级 | P0 |

#### 3.3.2 Agent列表页面

| 功能编号 | F-WEB-002 |
|---------|-----------|
| 功能名称 | Agent列表管理 |
| 功能描述 | 展示所有Agent及其状态 |
| 展示字段 | ID/平台/主机名称/状态/名/IP/最后活跃时间 |
| 操作功能 | 查看详情/删除Agent |
| 优先级 | P0 |

#### 3.3.3 Agent详情页面

| 功能编号 | F-WEB-003 |
|---------|-----------|
| 功能名称 | Agent详情查看 |
| 功能描述 | 展示单个Agent的详细信息和监控数据 |
| 标签页 | 基本信息 / 进程 / 端口 / 主机 / 软件 / USB / 登录日志 |
| 优先级 | P0 |

---

## 4. Phase 2: 行为基线与安全告警

### 4.1 基线管理功能

#### 4.1.1 学习模式

| 功能编号 | F-BASE-001 |
|---------|-------------|
| 功能名称 | 快速学习模式 |
| 功能描述 | 1小时学习窗口，快速建立临时基线 |
| 适用场景 | 快速测试、初次部署 |
| 优先级 | P1 |

| 功能编号 | F-BASE-002 |
|---------|-------------|
| 功能名称 | 标准学习模式 |
| 功能描述 | 7天学习窗口，建立稳定基线 |
| 适用场景 | 正式环境部署 |
| 优先级 | P0 |

| 功能编号 | F-BASE-003 |
|---------|-------------|
| 功能名称 | 自定义学习模式 |
| 功能描述 | 支持1-30天自定义学习周期 |
| 适用场景 | 根据业务需求调整 |
| 优先级 | P1 |

#### 4.1.2 基线创建方式

| 功能编号 | F-BASE-004 |
|---------|-------------|
| 功能名称 | 学习创建 |
| 功能描述 | 通过学习期自动收集数据创建基线 |
| 优先级 | P0 |

| 功能编号 | F-BASE-005 |
|---------|-------------|
| 功能名称 | 导入创建 |
| 功能描述 | 导入当前系统数据作为基线 |
| 优先级 | P1 |

| 功能编号 | F-BASE-006 |
|---------|-------------|
| 功能名称 | 复制创建 |
| 功能描述 | 从其他Agent复制基线配置 |
| 优先级 | P2 |

| 功能编号 | F-BASE-007 |
|---------|-------------|
| 功能名称 | 手动创建 |
| 功能描述 | 手动添加基线项目 |
| 优先级 | P2 |

#### 4.1.3 基线类型

| 基线类型 | 英文标识 | 监控内容 | 优先级 |
|----------|----------|----------|--------|
| 进程基线 | PROCESS | 运行中的进程列表 | P0 |
| 端口基线 | PORT | 监听端口列表 | P0 |
| USB设备基线 | USB | USB设备连接记录 | P1 |
| 登录基线 | LOGIN | 用户登录记录 | P1 |
| 软件基线 | SOFTWARE | 已安装软件列表 | P2 |

#### 4.1.4 基线操作API

| 接口编号 | API-BASE-001 |
|---------|---------------|
| 接口地址 | GET /api/baselines/{agentId} |
| 接口描述 | 获取Agent基线配置列表 |
| 响应数据 | BaselineConfig列表 |
| 优先级 | P0 |

| 接口编号 | API-BASE-002 |
|---------|---------------|
| 接口地址 | POST /api/baselines/{agentId}/{type}/quick-learn |
| 接口描述 | 启动快速学习 |
| 响应数据 | BaselineConfig |
| 优先级 | P1 |

| 接口编号 | API-BASE-003 |
|---------|---------------|
| 接口地址 | POST /api/baselines/{agentId}/{type}/standard-learn |
| 接口描述 | 启动标准学习 |
| 响应数据 | BaselineConfig |
| 优先级 | P0 |

| 接口编号 | API-BASE-004 |
|---------|---------------|
| 接口地址 | POST /api/baselines/{agentId}/{type}/custom-learn |
| 接口描述 | 启动自定义学习 |
| 请求参数 | days |
| 响应数据 | BaselineConfig |
| 优先级 | P1 |

| 接口编号 | API-BASE-005 |
|---------|---------------|
| 接口地址 | POST /api/baselines/{agentId}/{type}/import |
| 接口描述 | 导入当前数据作为基线 |
| 响应数据 | BaselineConfig |
| 优先级 | P1 |

| 接口编号 | API-BASE-006 |
|---------|---------------|
| 接口地址 | POST /api/baselines/{agentId}/{type}/copy |
| 接口描述 | 复制其他Agent基线 |
| 请求参数 | sourceAgentId |
| 响应数据 | BaselineConfig |
| 优先级 | P2 |

| 接口编号 | API-BASE-007 |
|---------|---------------|
| 接口地址 | GET /api/baselines/{agentId}/{type}/compare |
| 接口描述 | 对比当前数据与基线 |
| 响应数据 | BaselineCompareResult |
| 优先级 | P0 |

| 接口编号 | API-BASE-008 |
|---------|---------------|
| 接口地址 | DELETE /api/baselines/{agentId}/{type} |
| 接口描述 | 删除指定基线 |
| 响应数据 | 空 |
| 优先级 | P1 |

### 4.2 异常检测功能

#### 4.2.1 异常类型

| 异常类型 | 英文标识 | 描述 | 默认告警级别 |
|----------|----------|------|--------------|
| 新增项目 | NEW | 基线中不存在，当前系统存在 | MEDIUM |
| 缺失项目 | MISSING | 基线中存在，当前系统不存在 | LOW |
| 修改项目 | MODIFIED | 项目值发生变化 | LOW |

#### 4.2.2 检测规则

| 规则类型 | 检测内容 | 默认启用 |
|----------|----------|----------|
| 进程白名单 | 检测未知进程 | 是 |
| 端口白名单 | 检测未知端口 | 是 |
| USB设备检测 | 检测新USB设备插入 | 是 |
| 登录异常检测 | 检测异常登录行为 | 是 |
| 软件变更检测 | 检测新软件安装 | 否 |

### 4.3 告警管理功能

#### 4.3.1 告警级别

| 级别 | 英文标识 | 颜色 | 严重程度 |
|------|----------|------|----------|
| 严重 | CRITICAL | 红色 | 需要立即处理 |
| 高危 | HIGH | 橙色 | 需要尽快处理 |
| 中等 | MEDIUM | 黄色 | 需要关注 |
| 低危 | LOW | 蓝色 | 信息性告警 |

#### 4.3.2 告警状态

| 状态 | 英文标识 | 描述 |
|------|----------|------|
| 待处理 | NEW | 新生成的告警 |
| 已确认 | ACKNOWLEDGED | 管理员已确认 |
| 已解决 | RESOLVED | 问题已解决 |
| 已忽略 | IGNORED | 管理员忽略此告警 |

#### 4.3.3 告警操作

| 功能编号 | F-ALERT-001 |
|---------|-------------|
| 功能名称 | 查看告警列表 |
| 接口地址 | GET /api/alerts |
| 筛选条件 | 状态/级别/Agent/时间范围 |
| 优先级 | P0 |

| 功能编号 | F-ALERT-002 |
|---------|-------------|
| 功能名称 | 查看告警详情 |
| 接口地址 | GET /api/alerts/{id} |
| 展示内容 | 告警完整信息、基线对比数据 |
| 优先级 | P0 |

| 功能编号 | F-ALERT-003 |
|---------|-------------|
| 功能名称 | 确认告警 |
| 接口地址 | POST /api/alerts/{id}/acknowledge |
| 记录信息 | 确认人、确认时间 |
| 优先级 | P0 |

| 功能编号 | F-ALERT-004 |
|---------|-------------|
| 功能名称 | 解决告警 |
| 接口地址 | POST /api/alerts/{id}/resolve |
| 记录信息 | 解决人、解决时间、解决备注 |
| 优先级 | P0 |

| 功能编号 | F-ALERT-005 |
|---------|-------------|
| 功能名称 | 忽略告警 |
| 接口地址 | POST /api/alerts/{id}/ignore |
| 记录信息 | 忽略人、忽略时间、忽略原因 |
| 优先级 | P1 |

| 功能编号 | F-ALERT-006 |
|---------|-------------|
| 功能名称 | 告警统计 |
| 接口地址 | GET /api/alerts/stats |
| 统计项 | 待处理/已确认/已解决/已忽略/严重告警数量 |
| 优先级 | P0 |

### 4.4 告警规则管理

#### 4.4.1 规则类型

| 规则类型 | 英文标识 | 描述 |
|----------|----------|------|
| 进程检测 | PROCESS | 进程相关检测规则 |
| 端口检测 | PORT | 端口相关检测规则 |
| USB检测 | USB | USB设备检测规则 |
| 登录检测 | LOGIN | 登录行为检测规则 |
| 软件检测 | SOFTWARE | 软件变更检测规则 |

#### 4.4.2 规则操作

| 接口编号 | API-RULE-001 |
|---------|---------------|
| 接口地址 | GET /api/alerts/rules |
| 接口描述 | 获取所有告警规则 |
| 优先级 | P1 |

| 接口编号 | API-RULE-002 |
|---------|---------------|
| 接口地址 | POST /api/alerts/rules |
| 接口描述 | 创建新告警规则 |
| 请求参数 | ruleType, ruleName, ruleCondition, alertLevel, actionType, enabled |
| 优先级 | P2 |

| 接口编号 | API-RULE-003 |
|---------|---------------|
| 接口地址 | PUT /api/alerts/rules/{id}/toggle |
| 接口描述 | 启用/禁用规则 |
| 请求参数 | enabled |
| 优先级 | P1 |

| 接口编号 | API-RULE-004 |
|---------|---------------|
| 接口地址 | DELETE /api/alerts/rules/{id} |
| 接口描述 | 删除告警规则 |
| 优先级 | P2 |

---

## 5. 非功能需求

### 5.1 性能需求

| 指标 | 要求 |
|------|------|
| API响应时间 | < 500ms |
| 并发Agent数 | > 100 |
| 数据采集间隔 | 可配置，默认60秒 |
| 心跳间隔 | 可配置，默认30秒 |
| 基线对比耗时 | < 5秒 |

### 5.2 可用性需求

| 指标 | 要求 |
|------|------|
| 系统可用性 | > 99.9% |
| 数据保留期 | 90天（可配置） |
| 告警延迟 | < 1秒 |
| Agent离线支持 | 本地缓存+断网重连 |

### 5.3 安全需求

| 需求编号 | 需求描述 |
|----------|----------|
| SEC-001 | Agent注册时分配唯一ID |
| SEC-002 | 所有API请求携带Agent ID |
| SEC-003 | 输入数据校验 |
| SEC-004 | 防止SQL注入 |
| SEC-005 | 操作日志审计 |

### 5.4 兼容性需求

| 平台 | Agent支持版本 |
|------|---------------|
| Windows | Windows 10 / Windows Server 2016+ |
| Linux | Ubuntu 18.04+ / CentOS 7+ / Debian 10+ |
| macOS | macOS 10.15+ (可选) |

---

## 6. 约束条件

### 6.1 技术约束

| 约束项 | 详情 |
|--------|------|
| 后端框架 | Java 17 + SpringBoot 3.2 |
| 前端框架 | Vue 3 + Element Plus |
| 数据库 | MySQL 8.0+ |
| Agent语言 | Python 3.8+ |
| 操作系统 | 无特殊要求 |

### 6.2 业务约束

| 约束项 | 详情 |
|--------|------|
| 单Agent基线类型 | 最多5种 |
| 学习期最大天数 | 30天 |
| 单次采集数据量 | 最大500条 |
| 告警数据保留 | 90天 |

---

## 7. 验收标准

### 7.1 Phase 1验收标准

- [ ] Agent支持Windows和Linux双平台
- [ ] Agent能够自动注册到服务器
- [ ] Agent按设定间隔上报心跳
- [ ] Agent能够采集所有规定的系统信息
- [ ] Agent支持离线缓存和断网重连
- [ ] 后端能够接收和存储Agent数据
- [ ] 后端提供完整的REST API
- [ ] Web界面能够展示Agent列表
- [ ] Web界面能够查看Agent详细信息
- [ ] Web界面能够查看进程和端口列表

### 7.2 Phase 2验收标准

- [ ] 支持快速学习（1小时）
- [ ] 支持标准学习（7天）
- [ ] 支持自定义学习（1-30天）
- [ ] 支持5种基线类型
- [ ] 支持导入当前数据创建基线
- [ ] 支持基线对比功能
- [ ] 支持新增/缺失/修改三类异常检测
- [ ] 支持4种告警级别
- [ ] 支持4种告警状态
- [ ] 支持告警确认、解决、忽略操作
- [ ] 支持自定义告警规则

---

## 8. 术语表

| 术语 | 英文 | 定义 |
|------|------|------|
| Agent | Agent | 部署在终端的监控程序 |
| 基线 | Baseline | 系统正常运行时的标准状态数据 |
| 异常 | Anomaly | 偏离基线的行为或状态 |
| 告警 | Alert | 检测到异常时生成的安全通知 |
| 进程 | Process | 运行的程序实例 |
| 端口 | Port | 网络通信端点 |
| 心跳 | Heartbeat | Agent定期向服务器发送的生命信号 |
| 采集 | Collect | Agent获取系统信息的过程 |
| 上报 | Upload | Agent向服务器发送数据的过程 |
