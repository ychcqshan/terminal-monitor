# 终端安全监控系统 - Phase 2 需求文档

## 版本信息

| 项目 | 内容 |
|------|------|
| 版本号 | v1.0.0 |
| 文档版本 | 2.0 |
| 创建日期 | 2026-02-11 |
| 状态 | 已完成 |

---

## 1. 项目概述

终端安全监控系统是一个轻量级的终端安全监控解决方案，包含三个主要组件：

1. **Agent** (Python 3.8+)：收集系统信息（进程、端口）并上报到后端
2. **Backend** (Java SpringBoot 3.2)：API服务器，用于数据处理和MySQL存储
3. **Web** (Vue 3 + Element Plus)：管理界面，用于监控Agent

---

## 2. Phase 2 功能概述

Phase 2 专注于**行为基线与安全告警**功能，实现以下核心能力：

- **行为基线学习**：通过学习正常行为建立安全基线
- **异常检测**：实时检测偏离基线的异常行为
- **安全告警**：生成、通知和管理安全告警
- **告警响应**：支持告警确认、解决、忽略等操作

---

## 3. 功能需求

### 3.1 基线管理功能

#### 3.1.1 学习模式

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 快速学习 | 1小时学习窗口，快速建立临时基线 | 高 |
| 标准学习 | 7天学习窗口，建立稳定基线 | 高 |
| 自定义学习 | 支持1-30天自定义学习周期 | 中 |
| 学习状态显示 | 实时显示学习进度和状态 | 高 |

#### 3.1.2 基线创建方式

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 学习创建 | 通过学习期自动收集数据创建基线 | 高 |
| 导入创建 | 导入当前系统数据作为基线 | 高 |
| 复制创建 | 从其他Agent复制基线配置 | 中 |
| 手动创建 | 手动添加基线项目 | 中 |

#### 3.1.3 基线类型

| 类型 | 描述 | 监控内容 |
|------|------|----------|
| PROCESS | 进程基线 | 运行中的进程列表 |
| PORT | 端口基线 | 监听端口列表 |
| USB | USB设备基线 | USB设备连接记录 |
| LOGIN | 登录基线 | 用户登录记录 |
| SOFTWARE | 软件基线 | 已安装软件列表 |

#### 3.1.4 基线操作

| 功能 | 描述 | API端点 |
|------|------|---------|
| 查看配置 | 获取Agent基线配置列表 | GET /api/baselines/{agentId} |
| 查看详情 | 获取特定基线配置 | GET /api/baselines/{agentId}/{type} |
| 查看快照 | 获取基线快照历史 | GET /api/baselines/{agentId}/{type}/snapshots |
| 查看项目 | 获取基线项目列表 | GET /api/baselines/{agentId}/{type}/items |
| 基线对比 | 对比当前数据与基线 | GET /api/baselines/{agentId}/{type}/compare |
| 删除基线 | 删除指定基线 | DELETE /api/baselines/{agentId}/{type} |

---

### 3.2 异常检测功能

#### 3.2.1 异常类型

| 异常类型 | 描述 | 告警级别 |
|----------|------|----------|
| NEW | 新增项目（基线中不存在） | MEDIUM |
| MISSING | 缺失项目（当前不存在于基线） | LOW |
| MODIFIED | 修改项目（值发生变化） | LOW |

#### 3.2.2 检测规则

| 规则类型 | 描述 | 默认启用 |
|----------|------|----------|
| 进程白名单 | 检测未知进程 | 是 |
| 端口白名单 | 检测未知端口 | 是 |
| USB设备检测 | 检测新USB设备 | 是 |
| 登录异常检测 | 检测异常登录 | 是 |
| 软件变更检测 | 检测新软件安装 | 是 |

---

### 3.3 告警管理功能

#### 3.3.1 告警级别

| 级别 | 描述 | 颜色标识 |
|------|------|----------|
| CRITICAL | 严重告警 | 红色 |
| HIGH | 高危告警 | 橙色 |
| MEDIUM | 中等告警 | 黄色 |
| LOW | 低危告警 | 蓝色 |

#### 3.3.2 告警状态

| 状态 | 描述 | 含义 |
|------|------|------|
| NEW | 待处理 | 新生成的告警 |
| ACKNOWLEDGED | 已确认 | 管理员已确认 |
| RESOLVED | 已解决 | 问题已解决 |
| IGNORED | 已忽略 | 管理员忽略此告警 |

#### 3.3.3 告警操作

| 操作 | 描述 | API端点 |
|------|------|---------|
| 查看告警 | 获取告警列表 | GET /api/alerts |
| 查看详情 | 获取告警详情 | GET /api/alerts/{id} |
| 确认告警 | 标记告警为已确认 | POST /api/alerts/{id}/acknowledge |
| 解决告警 | 标记告警为已解决 | POST /api/alerts/{id}/resolve |
| 忽略告警 | 标记告警为已忽略 | POST /api/alerts/{id}/ignore |
| 统计信息 | 获取告警统计 | GET /api/alerts/stats |

---

### 3.4 告警规则管理

#### 3.4.1 规则类型

| 类型 | 描述 |
|------|------|
| PROCESS | 进程检测规则 |
| PORT | 端口检测规则 |
| USB | USB检测规则 |
| LOGIN | 登录检测规则 |
| SOFTWARE | 软件检测规则 |

#### 3.4.2 规则操作

| 操作 | 描述 | API端点 |
|------|------|---------|
| 创建规则 | 新建告警规则 | POST /api/alerts/rules |
| 查看规则 | 获取规则列表 | GET /api/alerts/rules |
| 启用规则 | 启用指定规则 | PUT /api/alerts/rules/{id}/toggle |
| 删除规则 | 删除指定规则 | DELETE /api/alerts/rules/{id} |

---

## 4. 非功能需求

### 4.1 性能需求

| 指标 | 要求 |
|------|------|
| API响应时间 | < 500ms |
| 并发连接数 | > 100 |
| 告警生成延迟 | < 1s |
| 基线对比耗时 | < 5s |

### 4.2 可用性需求

| 指标 | 要求 |
|------|------|
| 系统可用性 | > 99.9% |
| 数据保留期 | 90天 |
| 告警通知 | 实时 |

### 4.3 安全需求

| 需求 | 描述 |
|------|------|
| 身份验证 | Agent注册认证 |
| 数据校验 | 输入数据验证 |
| 日志审计 | 操作日志记录 |

---

## 5. 约束条件

### 5.1 技术约束

- 后端：Java 17 + SpringBoot 3.2
- 前端：Vue 3 + Element Plus
- 数据库：MySQL 8.0+
- Agent：Python 3.8+

### 5.2 业务约束

- 单个Agent最多支持5种基线类型
- 学习期内最多保留500条历史数据
- 告警数据保留90天

---

## 6. 验收标准

### 6.1 基线管理验收标准

- [x] 支持快速学习（1小时）
- [x] 支持标准学习（7天）
- [x] 支持自定义学习（1-30天）
- [x] 支持5种基线类型
- [x] 支持导入当前数据创建基线
- [x] 支持复制其他Agent基线
- [x] 支持基线对比功能
- [x] 支持基线删除

### 6.2 告警管理验收标准

- [x] 支持4种告警级别
- [x] 支持4种告警状态
- [x] 支持告警确认
- [x] 支持告警解决
- [x] 支持告警忽略
- [x] 支持告警统计

### 6.3 规则管理验收标准

- [x] 支持自定义告警规则
- [x] 支持规则启用/禁用
- [x] 支持规则删除

---

## 7. 术语表

| 术语 | 定义 |
|------|------|
| 基线 | 系统正常运行时的标准状态数据 |
| 异常 | 偏离基线的行为或状态 |
| 告警 | 检测到异常时生成的安全通知 |
| Agent | 部署在终端的监控程序 |
